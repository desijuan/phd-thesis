%
% SECTION 3.1 - MORITA MORPHISMS
%

\section{Morita morphisms}\label{sec:morita}

% ESSENTIALLY SURJECTIVE
A morphism of Lie groupoids $\phi\colon(G\tto M)\to(G'\tto M')$ is \emph{essentially surjective} if the maps induced in the space of orbits \smash{$\overline\phi\colon M/G\to M'/G'$} and in the normal directions \smash{$\overline{d_x\phi}\colon N_xO\to N_{\phi(x)}O$} are surjective.
%
% FULLY FAITHFUL
It is \emph{fully faithful} if \smash{$\overline\phi\colon M/G\to M'/G'$} and \smash{$\overline{d_x\phi}\colon N_xO\to N_{\phi(x)}O$} are injective and \smash{$\phi_x\colon G_x\to G'_{\phi(x)}$} is an isomorphism.

\begin{prop}[\cite{dhf19}]\label{prop:dhfgpds}
A morphism of Lie groupoids $\phi\colon(G\tto M)\to(G'\tto M')$ is essentially surjective if and only if $t\pi_1\colon G'\times_{M'} M\to M'$ is a surjective submersion and it is fully faithful if and only if it induces a good pull-back between the anchors.
\begin{equation}
\begin{tikzcd}
 G \ar{r}{\phi} \ar{d}[swap]{(t, s)} & G' \ar{d}{(t, s)} \\
 M\times M \ar{r}{\phi\times\phi} & M'\times M'
\end{tikzcd}
\end{equation}
\end{prop}

% MORITA MORPHISMS
A morphism that is both fully faithful and essentially surjective is called a \emph{Morita morphism}.
We use a tilde $\sim$ to specify that a morphism is Morita.
\[ \begin{tikzcd}[sep = small]
 (G\tto M) \ar[shorten = -.15em]{r}[pos=.45, sloped, below]{\sim}[pos=.45, sloped, above]{\phi} & (G'\tto M')
\end{tikzcd} \]
%
% SURJECTIVE EQUIVALENCE
A \emph{surjective equivalence} is a Morita morphism in which the map on the objects $\phi_0\colon M\to M'$ is a surjective submersion.

% EX: POINT
\begin{example}
Let $M\times M\tto M$ be a pair groupoid.
The trivial morphism $(M\times M\tto M) \to (*\tto *)$ is Morita.
\end{example}

% EX: MANIFOLDS
\begin{example}
Let $f\colon M\to N$ be map of manifolds.
Seen as a morphism between the respective unit groupoids $f\colon (M\tto M) \to (N\tto N)$ is fully faithfull if and only it is an injective inmersion and it is is essentially surjective if and only if it is a surjective submersion.
So, a Morita morphism between manifolds is the same as a diffeomorphism.
\end{example}

% EX: SUBMERSION GPD
\begin{example}\label{submersion-morita}
Let $q\colon M\to N$ be a surjective submersion.
The induced map $(M\times_N M \tto M)\to(N\tto N)$ is Morita.
\end{example}

% EX: CECH GPD
\begin{example}
\v{C}ech groupoid
$\left( \coprod G(U_j,U_i) \tto \coprod U_i \right) \to \left( G\tto M \right)$.
\end{example}

The following example is a generalization of \ref{submersion-morita} above.
It relates the notions of Morita morphisms, categorical equivalences and isomorphisms in the context of Lie groupoids.

% EX: MORITA MORPHISMS, CATEGORICAL EQUIVALENCES AND ISOMORPHISMS ARE DISTINCT NOTIONS
\begin{example}
Let $q\colon M\to N$ a submersion.
The induced map $(M\times_N M\tto N)\to (N\tto N)$ is Morita if and only if $q$ is surjective, it is a categorical equivalence if and only if $q$ admits a global section, and an isomorphism of Lie groupoids if and only if $q$ is a diffeomorphism.
In particular, this example shows that for Lie groupoids, Morita morphisms, categorical equivalences and isomorphisms are distinct notions, and Morita equivalence is the weakest of the three.
\end{example}

% EX: TRANSITIVE GPD
\begin{example}
Let $G\tto M$ be a transitive groupoid.
For every $x$ in $M$ the inclusion
$(G_x\tto x) \hookrightarrow (G\tto M)$
is a Morita morphism.
\end{example}

\begin{lemma}\label{ES-and-stFF}
Let $\phi: (G\tto M) \to (H\tto N)$ be a moriphism of Lie groupoids.
If $\phi$ is essentially surjective and set-theoretically fully faithful, then it is Morita.
\end{lemma}

\begin{proof}
In first place observe that for every $x,x'\in M$ the map $\phi_{x',x}: G(x',x)\to H(\phi(x'),\phi(x))$ has constant rank, since it is equivariant with respect to the actions of the Lie groups $G_x$ and $H_{\phi(x)}$.
So, as $\phi$ is set-theoretically fully faithful, the maps $\phi_{x',x}: G(x',x)\to H(\phi(x'),\phi(x))$ are all diffeomorphisms.

Let us use this to prove that the map $(\phi,t,s): G\to H\times_{N\times N} (M\times M)$ is a diffeomorphism.
A vector $v\in T_gG$ in the kernel of the differential of $(\phi,t,s)$ is both in the kernel of the differential of $\phi$ and of the anchor map $(t,s)$.
The last condition implies that $v$ is actually in $T_gG(x',x)$ and the fist implies that it must be zero.
The bijection $(\phi,t,s): G\to H\times_{N\times N} (M\times M)$ turns out to be an immersion, therefore a diffeomorphism.
\end{proof}

\noindent COMENTARIO: Ã“RBITAS SON SUBVARIEDADES.

\begin{coro}
A morphism of Lie groupoids $\phi: (G\tto M) \to (H\tto N)$ is Morita if and only if it meets tranversely every orbit of $H$ and is set-theoretically fully faithful.
\end{coro}

This \nota{pongo esto como un lema?} is equivalent to asking that the following conditions hold: for every $y\in M$ there is another $x\in N$ and an arrow $\smash{y\xfrom{g}\psi(x)}\in G$, and for each $x\in N$ the induced linear map in the normal directions \smash{$\overline{d_x\psi}\colon T_xN\to N_{\psi(x)}O$} is surjective.
Here $N_{\psi(x)}O \subset T_{\psi(x)}M$ is the normal space to the orbit $O_x\subset M$ and $N_xO=T_xN$, since $N\tto N$ is a unit groupoid.
By proposition \ref{prop:dhfgpds}, a smooth map $\psi\colon N\to M$ meets transversally every orbit of $G\tto M$ if and only if the map $t\pi_1\colon G\times_M N\to M$ is a surjective sumbmersion.

% PULL-BACK
If $\psi\colon N\to M$ meets transversally every orbit of $G\tto M$, the map $\psi\times\psi\colon N\times N\to M\times M$ and the anchor $(t,s)\colon G\to M\times M$ are transversal.
So, we can consider the fiber product $G\times_{M\times M} (N\times N)$.
The \emph{pull-back} of $G\tto M$ along $\psi$, denoted by $\psi^*G$, is the Lie groupoid
\( G\times_{M\times M} (N\times N) \tto N \)
with source and target maps $s(g,y,x) = x$ and $t(g,y,x) = y$, composition $(h,z,y)\circ(g,y,x) = (hg,z,x)$, unit $u(x) = (u_{\psi(x)},x,x)$ and inversion $i(g,y,x) = (g^{-1},x,y)$.
There is also an induced map of Lie groupoids
\( (\psi^*G\tto N) \to (G\tto M) \)
that is Morita.

Note \nota{esto se puede relacionar con equiv de lie 2gpds} that a morphism of Lie groupoids $\phi\colon (G\tto M)\to (H\tto N)$ is Morita if and only if the map on the objects $\phi_0\colon M\to N$ meets transversally every orbit of $H$ and the map $G_1\to \phi^*H_1$ is a diffeomorphism.

% EX: SUBMERSION GPD
\begin{example}\label{ex:submersion_gpd_pb}
The pullback of a unit groupoid $N\tto N$ along a surjective submersion $q\colon M\to N$ is the submersion groupoid $M\times_N M\tto M$ of example \ref{ex:submersion_gpd}.
Note that this implies that the map
\( q\colon (M\times_N M\tto M) \xto\sim  (N\tto N) \)
is Morita.
Actually, the converse is also true.
A Lie groupoid that is Morita equivalent to a unit groupoid has to be a submersion groupoid.
\end{example}

% EX: CECH
\begin{example}\label{ex:cech}
The pullback of a unit groupoid $M\tto M$ along an open cover $q\colon \coprod U_i \to M$ is the \v Cech groupoid
\( M_\U = \big( \coprod U_{ji}\tto \coprod U_i \big) \)
of example \ref{ex:cover}.
Genralizing this, let us consider the pullback along an open cover $q\colon \coprod U_i \to M$ of a general Lie groupoid $G\tto M$.
The \v Cech groupoid
\( G_\U = \big( \coprod G(U_j,G_i)\tto \coprod U_i \big) \)
has the $(x,i)$ whith $x$ in $U_i$ as objects and the $(g,i,j)$ with $g$ in $G(U_j,U_i) = t^{-1}(U_j)\cap s^{-1}(U_i)$ as arrows.
There is a canonical morphism of Lie groupoids
\( \pi_\U\colon \big( \coprod G(U_j,U_i) \tto \coprod U_i \big) \to (G \tto M) \)
that is Morita.
\end{example}
